# Stable Bedrock Configuration - LOCKED FOR REGRESSION TRACKING
# This file defines the canonical evaluation environment
# DO NOT MODIFY without creating a new versioned baseline

# =============================================================================
# STABLE RATE LIMITING (Anti-Throttling - Proven Settings)
# =============================================================================

# Queue Client Concurrency Control (Critical for USE_BEDROCK_QUEUE=1)
export USE_BEDROCK_QUEUE=1
export ASYNC_MAX_CONCURRENCY=1                    # Single async operation at a time
export BEDROCK_MAX_CONCURRENCY=1                  # Single concurrent request

# Evaluator-Level Rate Limiting (Conservative - Proven to work)
export BEDROCK_MAX_RPS=0.15                       # Very conservative rate
export BEDROCK_COOLDOWN_SEC=30                    # Long cooldown after 429s
export BEDROCK_RETRY_MAX=8                        # More retries
export BEDROCK_RETRY_BASE=1.8                     # Exponential backoff
export BEDROCK_RETRY_MAX_SLEEP=20                 # Max sleep time

# Disable Coverage Rewrite (Major Source of Bedrock Calls)
export RAGCHECKER_COVERAGE_REWRITE=0              # Disable coverage rewrite

# Reduce JSON Usage (Prevent Repair Loops)
export RAGCHECKER_JSON_PROMPTS=0                  # Disable JSON prompts
export RAGCHECKER_JSON_MAX_TOKENS=200             # Small token budget if JSON used

# Evidence Selection (Minimal)
export RAGCHECKER_EVIDENCE_JACCARD=0.07
export RAGCHECKER_EVIDENCE_COVERAGE=0.20

# AWS Configuration
export AWS_REGION=us-east-1
export BEDROCK_MODEL_ID=anthropic.claude-3-haiku-20240307-v1:0

# =============================================================================
# LOCK VERIFICATION
# =============================================================================
# This configuration is LOCKED for regression tracking
# Last updated: 2025-09-04
# Git commit: [TO BE SET BY AUTOMATION]
# Proven to work without throttling across multiple evaluation runs
