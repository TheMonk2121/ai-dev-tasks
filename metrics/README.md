# Test Signal Metrics

This directory contains test signal analysis artifacts generated by the nightly test signal workflow.

## Files

### `tests_signal.csv`
The main output of the test signal analysis system. Contains test scoring and decision recommendations.

**Columns:**
- `test_id`: Full test identifier (e.g., `test_module.py::test_function`)
- `score`: Overall test importance score (0.0-1.0)
- `unique_lines`: Number of lines covered only by this test
- `weighted_unique`: Uniqueness weighted by file churn and complexity
- `runtime_sec`: Test execution time in seconds
- `fail_rate`: Historical failure rate (0.0-1.0)
- `avg_churn`: Average churn of files covered by this test
- `cluster_rep`: Whether this test is a cluster representative (0/1)
- `decision`: Recommended action (`keep`, `quarantine`, `retire`)

**Decision Logic:**
- `keep`: Score ≥ 0.6 OR has unique lines > 0
- `quarantine`: Score ≥ 0.3 (run nightly only)
- `retire`: Score < 0.3 (consider removing)

### Input Files (Generated by CI)
- `coverage.json`: Per-test coverage contexts from pytest-cov
- `durations.txt`: Test execution times from pytest --durations
- `churn.txt`: File change frequency from git log
- `complexity.json`: Cyclomatic complexity from radon
- `junit_latest.xml`: Latest test results from pytest

## Usage

The test signal system helps prioritize which tests to run in different scenarios:

1. **PR Runs**: Run only `keep` tests for fast feedback
2. **Nightly Runs**: Run all tests including `quarantine` tests
3. **Cleanup**: Review `retire` tests for potential removal

## Scoring Weights

- **Unique Coverage**: 45% (tests covering unique code paths)
- **Failure Rate**: 20% (tests that catch real bugs)
- **Change Coupling**: 15% (tests covering frequently changed code)
- **Mutation Score**: 10% (placeholder for future mutation testing)
- **Runtime Cost**: -8% (penalty for slow tests)
- **Flakiness**: -12% (penalty for unreliable tests)
